# 一、位运算

## 1. 原码、反码和补码

计算机中的有符号数有三种表示方法，即原码、反码和补码，三种表示方法均有符号位和数值位两部分，在计算机系统中，**数值一律用补码来表示和存储**。

**符号位**：最高位为符号位，0表示正、1表示负。在位运算中，符号位也参与运算。

**原码**：即数字正常的二进制表示，其中有一位符号位：

```python
# 3 和 -3 的原码：
# 00 00 00 11 : 3
# 10 00 00 11 : -3
```

**反码**：正数的反码就是原码，负数的反码是其原码的符号位不变，其他位取反：

```python
# 3 和 -3 的反码：
# 00 00 00 11 : 3
# 11 11 11 00 : -3
```

**补码**：正数的补码就是原码，负数的补码是其反码+1：

```python
# 3 和 -3 的补码：
# 00 00 00 11 : 3
# 11 11 11 01 : -3
```

在计算机中使用补码：

- 可以将符号位和数值域统一处理
- 加法和减法也可以统一处理
- 补码与原码相互转换，其运算过程是相同的，不需要额外的硬件电路

## 2. 按位运算

### 按位非：~

把 `n` 的补码中的0和1全部取反（0变1,1变0）：

```python
# 5 的补码 : 00 00 01 01
#    ~5   : 11 11 10 10 : -6
# -5的补码 : 11 11 10 11
#   ~-5   : 00 00 01 00 : 4
```

可以简单总结出来一个计算结论： `~n = -(n+1)` 

### 按位与：&

当 `n` 和 `m` 对应位都是1的时候才输出1，其他情况全是0：

```python
# 5 的补码 : 00 00 01 01
# 6 的补码 : 00 00 01 10
#  5 & 6  : 00 00 01 00 : 4
```

### 按位或：|

当 `n` 和 `m` 对应位只要有一个1就输出1，其他情况输出0：

```python
# 5 的补码 : 00 00 01 01
# 6 的补码 : 00 00 01 10
#  5 | 6  : 00 00 01 11 : 7
```

### 按位异或：^

只要 `n` 和 `m` 对应位不一样就输出1（异或操作满足交换律和结合律）：

```python
# 5 的补码 : 00 00 01 01
# 6 的补码 : 00 00 01 10
#  5 ^ 6  : 00 00 00 11 : 3
#  6 ^ 5  : 00 00 00 11 : 交换律
# 5 ^ 6 ^ 5 : 00 00 01 10 : 6
# 5 ^ 5 ^ 6 : 00 00 01 10 : 结合律
# 本例比较特殊：5与自己异或结果为0，而0与任何数异或结果为任何数
```

### 按位左移：<<

`n << i` 表示将n的二进制数向左移动 i 位，空位补0：

```python
# 5 的补码 : 00 00 01 01
# 5 << 2  : 00 01 01 00 : 20
```

### 按位右移：>>

`n >> i` 表示将n的二进制数向右移动 i 位：

```python
# 5 的补码 : 00 00 01 01
# 5 >> 2  : 00 00 00 01 : 1
```



















